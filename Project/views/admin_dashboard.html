<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard | MetroRail</title>
  <style>
    :root{
      --bg: #f6f8fb;
      --card: #ffffff;
      --muted: #6b7280;
      --text: #0f172a;
      --brand: #16a34a;   /* green */
      --brand-2:#22c55e;
      --border:#e5e7eb;
      --pill:#e8fff2;
      --danger:#ef4444;
      --shadow: 0 2px 24px rgba(2,6,23,0.06);
      --radius: 16px;
    }
    [data-theme="dark"]{
      --bg:#0b1220;
      --card:#0f172a;
      --muted:#9aa3b2;
      --text:#e5e7eb;
      --brand:#22c55e;
      --brand-2:#34d399;
      --border:#1f2937;
      --pill:rgba(34,197,94,.08);
      --shadow: 0 4px 28px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, Apple Color Emoji, Segoe UI Emoji;
      background:var(--bg);
      color:var(--text);
      line-height:1.45;
    }
    a{color:inherit}
    .container{max-width:1200px;margin:0 auto;padding:24px}
    /* Header / Nav */
    header{
      position:sticky; top:0; z-index:50;
      background:linear-gradient(180deg, rgba(255,255,255,.75), rgba(255,255,255,0));
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
    }
    [data-theme="dark"] header{
      background:linear-gradient(180deg, rgba(15,23,42,.85), rgba(15,23,42,0));
    }
    .nav{
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 24px; gap:16px;
    }
    .brand{display:flex; align-items:center; gap:12px; font-weight:800; font-size:20px;}
    .brand img{width:40px;height:40px;border-radius:10px;box-shadow:var(--shadow)}
    .menu{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
    .menu a{
      text-decoration:none; padding:10px 14px; border-radius:999px;
      border:1px solid var(--border); background:var(--card);
      box-shadow: var(--shadow); font-weight:600; opacity:.92;
      display:inline-flex; gap:8px; align-items:center;
    }
    .menu a.active{ background: linear-gradient(135deg, var(--pill), #fff); border-color: rgba(34,197,94,.35); }
    .menu .spacer{flex:1 1 auto}
    .theme-toggle, .logout-btn{
      padding:10px 14px; border-radius:999px; border:1px solid var(--border);
      background:var(--card); font-weight:700; cursor:pointer;
      box-shadow:var(--shadow);
    }
    .logout-btn{
      background: linear-gradient(135deg, var(--danger), #dc2626);
      border: none;
      color: #f60606;
      text-decoration:none;
      display:inline-flex; align-items:center; gap:8px;
    }
    .logout-btn:hover{ transform: translateY(-1px); }
    /* Flash */
    .flash{
      margin: 16px auto 0; max-width: 1200px;
      padding:12px 16px; border-radius: 12px;
      border:1px solid var(--border); background:var(--card);
      box-shadow:var(--shadow); font-weight:600;
    }
    .flash.info{border-color:#93c5fd}
    .flash.error{border-color:#fca5a5}
    /* Overview cards */
    .grid{display:grid; gap:18px}
    .grid-4{grid-template-columns: repeat(4, 1fr)}
    .grid-2{grid-template-columns: repeat(2, 1fr)}
    @media (max-width: 1000px){ .grid-4{grid-template-columns: repeat(2,1fr)} }
    @media (max-width: 640px){ .grid-4,.grid-2{grid-template-columns: 1fr} }
    .card{
      background:var(--card); border:1px solid var(--border);
      border-radius:var(--radius); padding:20px; box-shadow:var(--shadow);
    }
    .kpi{
      display:flex; align-items:center; justify-content:space-between;
      min-height:110px;
    }
    .kpi .label{color:var(--muted); font-weight:600}
    .kpi .value{font-size:36px; font-weight:900}
    .kpi .icon{font-size:26px; padding:10px; border-radius:14px; background:var(--pill)}
    /* Sections */
    .section-title{font-size:22px; font-weight:900; display:flex; align-items:center; gap:12px; margin: 0 0 12px 0;}
    .section-title .right{margin-left:auto; font-size:14px; color:var(--muted)}
    .pill{
      background:var(--pill); padding:8px 12px; border-radius:999px; font-weight:700; border:1px solid rgba(34,197,94,.25)
    }
    .panel{
      min-height:230px; display:flex; align-items:center; justify-content:center;
      border:2px dashed rgba(148,163,184,.35); color: #0ea5e9; font-weight:800; border-radius:14px;
      background:linear-gradient(180deg, rgba(34,197,94,.06), transparent);
    }
    /* Recent activity */
    .activity{display:flex; flex-direction:column; gap:12px}
    .activity-item{
      display:flex; gap:14px; align-items:flex-start; padding:14px; border-radius:12px;
      background:linear-gradient(180deg, rgba(34,197,94,.08), rgba(34,197,94,.03));
      border:1px solid rgba(34,197,94,.25);
    }
    .activity-item .a-icon{font-size:20px}
    .activity-item .a-meta{font-size:12px; color:var(--muted)}
    .right-link{font-weight:800; text-decoration:none}
    /* Quick Actions */
    .quick-grid{display:grid; grid-template-columns: repeat(4,1fr); gap:14px}
    @media (max-width: 900px){ .quick-grid{grid-template-columns: repeat(2,1fr)} }
    @media (max-width: 560px){ .quick-grid{grid-template-columns: 1fr} }
    .q-item{
      display:flex; align-items:center; gap:12px; text-decoration:none;
      border:1px solid var(--border); background:var(--card); padding:16px; border-radius:14px; box-shadow:var(--shadow); font-weight:700;
    }
    .q-icon{font-size:22px; padding:8px; border-radius:12px; background:var(--pill)}
    footer{padding:40px 0; color:var(--muted); text-align:center}
  </style>
</head>
<body data-theme="light">
  <header>
    <div class="nav">
      <div class="brand">
        <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/image-RCmcphX4mo26kjSE8kGXPrxOFmO8sM.png" alt="MetroRail Logo" onerror="this.style.display='none'"/>
        <span>MetroRail</span>
      </div>
      <div class="menu" style="flex:1">
        <a href="{{ url_for('main_routes.admin_dashboard') }}" class="active">ğŸ  <span>Dashboard</span></a>
        <a href="#">ğŸ’³ <span>Bookings</span></a>
        <a href="{{ url_for('main_routes.admin_schedules') }}">ğŸ—“ï¸ <span>Schedules</span></a>
        <a href="#">ğŸ‘¥ <span>Users</span></a>
        <span class="spacer"></span>
        <button class="theme-toggle" id="themeToggle" title="Toggle theme">ğŸŒ“</button>
        <!-- NEW LOGOUT BUTTON -->
        <a class="logout-btn" href="{{ url_for('main_routes.admin_logout') }}" title="Logout">ğŸšª Logout</a>
      </div>
    </div>
  </header>

  <!-- Flash messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="flash {{ category|lower }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <main class="container">
    <!-- KPIs -->
    <section class="grid grid-4">
      <div class="card kpi">
        <div>
          <div class="label">Total Bookings</div>
          <div class="value">{{ total_bookings if total_bookings is defined else 10 }}</div>
        </div>
        <div class="icon">ğŸŸï¸</div>
      </div>

      <div class="card kpi">
        <div>
          <div class="label">Revenue</div>
          <div class="value">à§³{{ revenue if revenue is defined else '870.00' }}</div>
        </div>
        <div class="icon">ğŸ’¹</div>
      </div>

      <div class="card kpi">
        <div>
          <div class="label">Average Occupancy</div>
          <div class="value">{{ avg_occupancy if avg_occupancy is defined else 87 }}</div>
        </div>
        <div class="icon">ğŸ§‘â€ğŸ¤â€ğŸ§‘</div>
      </div>

      <div class="card kpi">
        <div>
          <div class="label">System Uptime</div>
          <div class="value">{{ system_uptime if system_uptime is defined else 98 }}</div>
        </div>
        <div class="icon">âš¡</div>
      </div>
    </section>

    <!-- Charts -->
    <section style="margin-top:26px" class="grid grid-2">
      <div class="card">
        <div class="section-title">
          ğŸ“ˆ Revenue Trends
          <span class="right">
            <span class="pill">Last 7 Days</span>
          </span>
        </div>
        <div class="panel">Revenue chart visualization would appear here</div>
      </div>

      <div class="card">
        <div class="section-title">ğŸš† Train Occupancy</div>
        <div class="panel">Occupancy chart visualization would appear here</div>
      </div>
    </section>

    <!-- Recent Activity -->
    <section style="margin-top:26px" class="card">
      <div class="section-title">
        â±ï¸ Recent Activity
        <a href="#" class="right-link right">View All</a>
      </div>
      <div class="activity">
        <div class="activity-item">
          <div class="a-icon">ğŸ«</div>
          <div>
            <div class="a-title"><strong>New booking for Green Line Express</strong></div>
            <div class="a-meta">2 minutes ago</div>
          </div>
        </div>
        <div class="activity-item">
          <div class="a-icon">ğŸš„</div>
          <div>
            <div class="a-title"><strong>Train MR-003 completed maintenance</strong></div>
            <div class="a-meta">15 minutes ago</div>
          </div>
        </div>
        <div class="activity-item">
          <div class="a-icon">ğŸ§‘â€ğŸ¤â€ğŸ§‘</div>
          <div>
            <div class="a-title"><strong>New user registered: john.doe@email.com</strong></div>
            <div class="a-meta">1 hour ago</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Quick Actions -->
    <section style="margin-top:26px">
      <div class="section-title">âš¡ Quick Actions</div>
      <div class="quick-grid">
        <a class="q-item" href="{{ url_for('main_routes.admin_schedules') }}"><span class="q-icon">â•</span> Add New Schedule</a>
        <a class="q-item" href="{{ url_for('main_routes.announcements') }}"><span class="q-icon">ğŸ“°</span> Add announcement</a>
        <a class="q-item" href="#"><span class="q-icon">ğŸ“Š</span> View Reports</a>
        <a class="q-item" href="#"><span class="q-icon">âš™ï¸</span> System Settings</a>
      </div>
    </section>
  </main>

  <footer>
    Â© {{  now().year if now is defined else '2025' }} MetroRail â€” Admin Dashboard
  </footer>

  <script>
    // Theme persistence
    const key = "admin-theme";
    const saved = localStorage.getItem(key);
    if(saved){ document.body.setAttribute("data-theme", saved); }

    document.getElementById("themeToggle").addEventListener("click", () => {
      const current = document.body.getAttribute("data-theme") || "light";
      const next = current === "light" ? "dark" : "light";
      document.body.setAttribute("data-theme", next);
      localStorage.setItem(key, next);
    });
  </script>
</body>
</html>
